<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OAuth Identity and Authorization Chaining Across Domains</title>
<meta content="Arndt Schwenkschuster" name="author">
<meta content="Pieter Kasselmann" name="author">
<meta content="Kelley Burgin" name="author">
<meta content="Mike Jenkins" name="author">
<meta content="Brian Campbell" name="author">
<meta content="
       This specification defines a mechanism to preserve identity and authorization information across trust domains that use the OAuth 2.0 Framework. 
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="draft-ietf-oauth-identity-chaining-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-oauth-identity-chaining.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">OAuth Identity and Authorization Chainin</td>
<td class="right">December 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Schwenkschuster, et al.</td>
<td class="center">Expires 13 June 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">oauth</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-oauth-identity-chaining-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-12-10" class="published">10 December 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-06-13">13 June 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Schwenkschuster</div>
<div class="org">SPIRL</div>
</div>
<div class="author">
      <div class="author-name">P. Kasselmann</div>
<div class="org">SPIRL</div>
</div>
<div class="author">
      <div class="author-name">K. Burgin</div>
<div class="org">MITRE</div>
</div>
<div class="author">
      <div class="author-name">M. Jenkins</div>
<div class="org">NSA-CCSS</div>
</div>
<div class="author">
      <div class="author-name">B. Campbell</div>
<div class="org">Ping Identity</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OAuth Identity and Authorization Chaining Across Domains</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification defines a mechanism to preserve identity and authorization information across trust domains that use the OAuth 2.0 Framework.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Web Authorization Protocol Working Group mailing list (oauth@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/oauth/">https://mailarchive.ietf.org/arch/browse/oauth/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/oauth-wg/oauth-identity-chaining">https://github.com/oauth-wg/oauth-identity-chaining</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 13 June 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-identity-and-authorization-" class="internal xref">Identity and Authorization Chaining Across Domains</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-authorization-server-discov" class="internal xref">Authorization Server Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-token-exchange" class="internal xref">Token Exchange</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-token-exchange-request" class="internal xref">Token Exchange Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-processing-rules" class="internal xref">Processing rules</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="auto internal xref">3.3.3</a>.  <a href="#name-token-exchange-response" class="internal xref">Token Exchange Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="auto internal xref">3.3.4</a>.  <a href="#name-example" class="internal xref">Example</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-jwt-authorization-grant" class="internal xref">JWT Authorization Grant</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-access-token-request" class="internal xref">Access Token Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-processing-rules-2" class="internal xref">Processing rules</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="auto internal xref">3.4.3</a>.  <a href="#name-access-token-response" class="internal xref">Access Token Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="auto internal xref">3.4.4</a>.  <a href="#name-example-2" class="internal xref">Example</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-claims-transcription" class="internal xref">Claims transcription</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-client-authentication" class="internal xref">Client Authentication</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-use-cases" class="internal xref">Use cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-preserve-user-context-acros" class="internal xref">Preserve User Context across Multi-cloud, Multi-Hybrid environments</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-continuous-integration-acce" class="internal xref">Continuous Integration Accessing External Resources</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-api-security-use-case" class="internal xref">API Security Use Case</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-extend-single-sign-on-to-ap" class="internal xref">Extend Single-Sign-On to API Access</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#appendix-A.5" class="auto internal xref">A.5</a>.  <a href="#name-cross-domain-api-authorizat" class="internal xref">Cross-domain API authorization</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-resource-server-as-actor" class="internal xref">Resource server as Actor</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-authorization-server-as-act" class="internal xref">Authorization server as Actor</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Applications often require access to resources that are distributed across multiple trust domains where each trust domain has its own OAuth 2.0 authorization server. As a result, developers are often faced with the situation that a protected resource is located in a different trust domain and thus protected by a different authorization server. A request may transverse multiple resource servers in multiple trust domains before completing. All protected resources involved in such a request need to know on whose behalf the request was originally initiated (i.e. the user), what authorization was granted and optionally which other resource servers were called prior to making an authorization decision. This information needs to be preserved, even when a request crosses one or more trust domains. This document refers to this as "chaining" and defines a mechanism for preserving identity and authorization information across domains using a combination of OAuth 2.0 Token Exchange <span>[<a href="#RFC8693" class="cite xref">RFC8693</a>]</span> and JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document uses the following terms:<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">
          <p id="section-2-3.1.1">Actor<a href="#section-2-3.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-4">The role of "actor" represents any component in the OAuth system that performs the steps outlined in this document. While this document uses the term "actor" for clarity and to distinguish different roles and clients, in other contexts it should be referred to as "Actor in scope of Identity and Authorization Chaining".<a href="#section-2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identity-and-authorization-chaining-across-domains">
<section id="section-3">
      <h2 id="name-identity-and-authorization-">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-identity-and-authorization-" class="section-name selfRef">Identity and Authorization Chaining Across Domains</a>
      </h2>
<p id="section-3-1">This specification describes a combination of OAuth 2.0 Token Exchange <span>[<a href="#RFC8693" class="cite xref">RFC8693</a>]</span> and JWT Profile for OAuth 2.0 Client Authentication and Authorization Grants <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span> to achieve identity and authorization chaining across domains.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="overview">
<section id="section-3.1">
        <h3 id="name-overview">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-3.1-1">The identity and authorization chaining flow outlined below describes the steps the actor in Domain A performs to retrieve an access token for Domain B. The appendix include two concrete examples that describe how this flow is used. In one example, the resource server is the actor and in the other, the authorization server takes that role.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<span id="name-identity-and-authorization-c"></span><figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-3.1-2.1">
<pre>
+-------------+                            +-------------+ +---------+
|Authorization|        +----------+        |Authorization| |Protected|
|Server       |        |  Actor   |        |Server       | |Resource |
|Domain A     |        |(Domain A)|        |Domain B     | |Domain B |
+-------------+        +----------+        +-------------+ +---------+
       |                    |                     |             |
       |                    |----+                |             |
       |                    |    | (A) discover   |             |
       |                    |&lt;---+ Authorization  |             |
       |                    |      Server         |             |
       |                    |      Domain B       |             |
       |                    |                     |             |
       |                    |                     |             |
       | (B) exchange token |                     |             |
       |   [RFC 8693]       |                     |             |
       |&lt;-------------------|                     |             |
       |                    |                     |             |
       | (C) &lt;authorization |                     |             |
       |       grant JWT&gt;   |                     |             |
       | - - - - - - - - - &gt;|                     |             |
       |                    |                     |             |
       |                    | (D) present         |             |
       |                    | authorization grant |             |
       |                    | [RFC 7523]          |             |
       |                    | -------------------&gt;|             |
       |                    |                     |             |
       |                    | (E) &lt;access token&gt;  |             |
       |                    | &lt;- - - - - - - - - -|             |
       |                    |                     |             |
       |                    |               (F) access          |
       |                    | ---------------------------------&gt;|
       |                    |                     |             |
       |                    |                     |             |
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-identity-and-authorization-c" class="selfRef">Identity and Authorization Chaining Flow</a>
          </figcaption></figure>
<p id="section-3.1-3">The flow illustrated in Figure 1 shows the steps an actor in Domain A needs to perform to access a protected resource in Domain B. It is assumed, that the actor has a way to discover the authorization server in Domain B and a trust relationship exists between Domain A and Domain B (e.g., through federation). The steps outlined are the following:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.1">
            <p id="section-3.1-4.1.1">(A) The actor needs to discover the authorization server of Domain B. See <span><a href="#authorization-server-discovery" class="internal xref">Authorization Server Discovery</a> (<a href="#authorization-server-discovery" class="auto internal xref">Section 3.2</a>)</span>.<a href="#section-3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.2">
            <p id="section-3.1-4.2.1">(B) The actor exchanges its token at the authorization server of its own domain (Domain A) for a JWT authorization grant that can be used at the authorization server in Domain B. See <span><a href="#token-exchange" class="internal xref">Token Exchange</a> (<a href="#token-exchange" class="auto internal xref">Section 3.3</a>)</span>.<a href="#section-3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.3">
            <p id="section-3.1-4.3.1">(C) The authorization server of Domain A processes the request and returns a JWT authorization grant that is audienced to the authorization server of Domain B. This requires a trust relationship between Domain A and Domain B (e.g., through federation).<a href="#section-3.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.4">
            <p id="section-3.1-4.4.1">(D) The actor presents the authorization grant to the authorization server of Domain B. See <span><a href="#access-token-request" class="internal xref">Access Token Request</a> (<a href="#access-token-request" class="auto internal xref">Section 3.4.1</a>)</span>.<a href="#section-3.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.5">
            <p id="section-3.1-4.5.1">(E) Authorization server of Domain B validates the JWT authorization grant and returns an access token.<a href="#section-3.1-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.6">
            <p id="section-3.1-4.6.1">(F) The actor now possesses an access token to access the protected resource in Domain B. Depending on who the actor is it may directly access the resource or processes further (see examples). To help understanding the flow the diagram shows a direct access by the actor, however, this is not required.<a href="#section-3.1-4.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="authorization-server-discovery">
<section id="section-3.2">
        <h3 id="name-authorization-server-discov">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-authorization-server-discov" class="section-name selfRef">Authorization Server Discovery</a>
        </h3>
<p id="section-3.2-1">This specification does not define authorization server discovery. The actor <span class="bcp14">MAY</span> maintain a static mapping or use other means to identify the authorization server. The <code>authorization_servers</code> property in <span>[<a href="#I-D.ietf-oauth-resource-metadata" class="cite xref">I-D.ietf-oauth-resource-metadata</a>]</span> <span class="bcp14">MAY</span> be used.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">// TODO for the AS as actor profile: Maybe a hint by the OAuth client?<a href="#section-3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-exchange">
<section id="section-3.3">
        <h3 id="name-token-exchange">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-token-exchange" class="section-name selfRef">Token Exchange</a>
        </h3>
<p id="section-3.3-1">The actors performs a token exchange as defined in <span>[<a href="#RFC8693" class="cite xref">RFC8693</a>]</span> with the authorization server of its own domain (e.g., Domain A) to obtain a JWT authorization grant that is audienced to the authorization server of a different domain (e.g., Domain B) as specified in section 1.3 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div id="token-exchange-request">
<section id="section-3.3.1">
          <h4 id="name-token-exchange-request">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-token-exchange-request" class="section-name selfRef">Token Exchange Request</a>
          </h4>
<p id="section-3.3.1-1">The parameters described in section 2.1 of <span>[<a href="#RFC8693" class="cite xref">RFC8693</a>]</span> apply here with the following restrictions:<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.3.1-2">
            <dt id="section-3.3.1-2.1">scope</dt>
            <dd style="margin-left: 1.5em" id="section-3.3.1-2.2">
              <p id="section-3.3.1-2.2.1"><span class="bcp14">OPTIONAL</span>. Additional scopes to indicate scopes included in the returned JWT authorization grant. See <span><a href="#claims-transcription" class="internal xref">Claims transcription</a> (<a href="#claims-transcription" class="auto internal xref">Section 3.5</a>)</span>.<a href="#section-3.3.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.1-2.3">resource</dt>
            <dd style="margin-left: 1.5em" id="section-3.3.1-2.4">
              <p id="section-3.3.1-2.4.1"><span class="bcp14">REQUIRED</span> if audience is not set. URI of authorization server of targeting domain (Domain B).<a href="#section-3.3.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.1-2.5">audience</dt>
            <dd style="margin-left: 1.5em" id="section-3.3.1-2.6">
              <p id="section-3.3.1-2.6.1"><span class="bcp14">REQUIRED</span> if resource is not set. Well known/logical name of authorization server of targeting domain (Domain B).<a href="#section-3.3.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="processing-rules">
<section id="section-3.3.2">
          <h4 id="name-processing-rules">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-processing-rules" class="section-name selfRef">Processing rules</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-3.3.2-1.1">
              <p id="section-3.3.2-1.1.1">If the request itself is not valid or if the given resource or audience are unknown, or are unacceptable based on policy, the authorization server <span class="bcp14">MUST</span> deny the request.<a href="#section-3.3.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.2-1.2">
              <p id="section-3.3.2-1.2.1">The authorization server <span class="bcp14">MAY</span> add, remove or change claims. See <span><a href="#claims-transcription" class="internal xref">Claims transcription</a> (<a href="#claims-transcription" class="auto internal xref">Section 3.5</a>)</span>.<a href="#section-3.3.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="token-exchange-response">
<section id="section-3.3.3">
          <h4 id="name-token-exchange-response">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-token-exchange-response" class="section-name selfRef">Token Exchange Response</a>
          </h4>
<p id="section-3.3.3-1">All of section 2.2 of <span>[<a href="#RFC8693" class="cite xref">RFC8693</a>]</span> applies. In addition, the following applies to implementations that conform to this specification.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.3-2.1">
              <p id="section-3.3.3-2.1.1">The "aud" claim in the returned JWT authorization grant <span class="bcp14">MUST</span> identify the requested authorization server. This corresponds with <a href="https://datatracker.ietf.org/doc/html/rfc7523#section-3">RFC 7523 Section 3, Point 3</a> and is there to reduce misuse and to prevent clients from presenting access tokens as an authorization grant to an authorization server in a different domain.<a href="#section-3.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.3-2.2">
              <p id="section-3.3.3-2.2.1">The "aud" claim included in the returned JWT authorization grant <span class="bcp14">MAY</span> identify multiple authorization servers, provided that trust relationships exist with them (e.g. through federation). It is <span class="bcp14">RECOMMENDED</span> that the "aud" claim is restricted to a single authorization server to prevent an authorization server in one domain from presenting the client's authorization grant to an authorization server in a different trust domain. For example, this will prevent the authorization server in Domain B from presenting the authorization grant it received from the actor in Domain A to the authorization server for Domain C, effectively impersonating an entity from Domain A.<a href="#section-3.3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="example">
<section id="section-3.3.4">
          <h4 id="name-example">
<a href="#section-3.3.4" class="section-number selfRef">3.3.4. </a><a href="#name-example" class="section-name selfRef">Example</a>
          </h4>
<p id="section-3.3.4-1">The example below shows the message invoked by the actor in Domain A to perform token exchange with the authorization server in Domain A (https://as.a.org/auth) to receive a JWT authorization grant audienced to the authorization server in Domain B (https://as.b.org/auth).<a href="#section-3.3.4-1" class="pilcrow">¶</a></p>
<span id="name-token-exchange-request-2"></span><figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-3.3.4-2.1">
<pre>
POST /auth/token HTTP/1.1
Host: as.a.org
Content-Type: application/x-www-form-urlencoded

grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Atoken-exchange
&amp;resource=https%3A%2F%2Fas.b.org%2Fauth
&amp;subject_token=ey...
&amp;subject_token_type=urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-token-exchange-request-2" class="selfRef">Token exchange request</a>
            </figcaption></figure>
<span id="name-token-exchange-response-2"></span><figure id="figure-3">
            <div class="alignLeft art-text artwork" id="section-3.3.4-3.1">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-cache, no-store

{
  "access_token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJo
  dHRwczovL2FzLmEub3JnL2F1dGgiLCJleHAiOjE2OTUyODQwOTIsImlhdCI6MTY5N
  TI4NzY5Miwic3ViIjoiam9obl9kb2VAYS5vcmciLCJhdWQiOiJodHRwczovL2FzLm
  Iub3JnL2F1dGgifQ.304Pv9e6PnzcQPzz14z-k2ZyZvDtP5WIRkYPScwdHW4",
  "token_type":"N_A",
  "issued_token_type":"urn:ietf:params:oauth:token-type:jwt",
  "expires_in":60
}
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-token-exchange-response-2" class="selfRef">Token exchange response</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="jwt-authorization-grant">
<section id="section-3.4">
        <h3 id="name-jwt-authorization-grant">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-jwt-authorization-grant" class="section-name selfRef">JWT Authorization Grant</a>
        </h3>
<p id="section-3.4-1">The actor presents the JWT authorization grant it received from the authorization server of its own domain as an authorization grant to the authorization server in the domain of the resource server it wants to access (Domain B) as defined in <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div id="access-token-request">
<section id="section-3.4.1">
          <h4 id="name-access-token-request">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-access-token-request" class="section-name selfRef">Access Token Request</a>
          </h4>
<p id="section-3.4.1-1">The authorization grant is a JWT bearer token, which the actor uses to request an access token as described in the JWT Profile for OAuth 2.0 Client Authentication and Authorization Grants <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>. For the purpose of this specification the following descriptions apply:<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.4.1-2">
            <dt id="section-3.4.1-2.1">grant_type</dt>
            <dd style="margin-left: 1.5em" id="section-3.4.1-2.2">
              <p id="section-3.4.1-2.2.1"><span class="bcp14">REQUIRED</span>. As defined in Section 2.1 of <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span> the value <code>urn:ietf:params:oauth:grant-type:jwt-bearer</code> indicates the request is a JWT bearer assertion authorization grant.<a href="#section-3.4.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.4.1-2.3">assertion</dt>
            <dd style="margin-left: 1.5em" id="section-3.4.1-2.4">
              <p id="section-3.4.1-2.4.1"><span class="bcp14">REQUIRED</span>. Authorization grant returned by the token exchange (<code>access_token</code> response).<a href="#section-3.4.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.4.1-3">The actor <span class="bcp14">MAY</span> indicate the audience it is trying to access through the <code>scope</code> parameter or the <code>resource</code> parameter defined in <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-rules-1">
<section id="section-3.4.2">
          <h4 id="name-processing-rules-2">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-processing-rules-2" class="section-name selfRef">Processing rules</a>
          </h4>
<p id="section-3.4.2-1">The authorization server <span class="bcp14">MUST</span> validate the JWT authorization grant as specified in Sections 3 and 3.1 of <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>. The following processing rules also apply:<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2-2.1">
              <p id="section-3.4.2-2.1.1">The "aud" claim <span class="bcp14">MUST</span> identify the Authorization Server as a valid intended audience of the assertion using either the token endpoint as described Section 3 <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span> or the issuer identifier as defined in Section 2 of <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>.<a href="#section-3.4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.4.2-2.2">
              <p id="section-3.4.2-2.2.1">The authorization server <span class="bcp14">SHOULD</span> deny the request if it is not able to identify the subject.<a href="#section-3.4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.4.2-2.3">
              <p id="section-3.4.2-2.3.1">Due to policy the request <span class="bcp14">MAY</span> be denied (for instance if the federation from Domain A is not allowed).<a href="#section-3.4.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="access-token-response">
<section id="section-3.4.3">
          <h4 id="name-access-token-response">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-access-token-response" class="section-name selfRef">Access Token Response</a>
          </h4>
<p id="section-3.4.3-1">The authorization server responds with an access token as described in section 5.1 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-1">
<section id="section-3.4.4">
          <h4 id="name-example-2">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-example-2" class="section-name selfRef">Example</a>
          </h4>
<p id="section-3.4.4-1">The example belows shows how the actor presents an authorization grant to the authorization server in Domain B (https://as.b.org/auth) to receive an access token for a protected resource in Domain B.<a href="#section-3.4.4-1" class="pilcrow">¶</a></p>
<span id="name-assertion-request"></span><figure id="figure-4">
            <div class="alignLeft art-text artwork" id="section-3.4.4-2.1">
<pre>
POST /auth/token HTTP/1.1
Host: as.b.org
Content-Type: application/x-www-form-urlencoded

grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer
&amp;assertion=ey...
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-assertion-request" class="selfRef">Assertion request</a>
            </figcaption></figure>
<span id="name-assertion-response"></span><figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-3.4.4-3.1">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-cache, no-store

{
  "access_token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJo
  dHRwczovL2FzLmIub3JnL2F1dGgiLCJleHAiOjE2OTUyODQwOTIsImlhdCI6MTY5N
  TI4NzY5Miwic3ViIjoiam9obi5kb2UuMTIzIiwiYXVkIjoiaHR0cHM6Ly9iLm9yZy
  9hcGkifQ.CJBuv6sr6Snj9in5T8f7g1uB61Ql8btJiR0IXv5oeJg",
  "token_type":"Bearer",
  "expires_in":60
}
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-assertion-response" class="selfRef">Assertion response</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="claims-transcription">
<section id="section-3.5">
        <h3 id="name-claims-transcription">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-claims-transcription" class="section-name selfRef">Claims transcription</a>
        </h3>
<p id="section-3.5-1">Authorization servers <span class="bcp14">MAY</span> transcribe claims when either producing JWT authorization grants in the token exchange flow or access tokens in the assertion flow.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-2.1">
            <p id="section-3.5-2.1.1"><strong>Transcribing the subject identifier</strong>: Subject identifier can differ between the parties involved. For instance: A user is known at domain A by "johndoe@a.org" but in domain B by "doe.john@b.org". The mapping from one identifier to the other <span class="bcp14">MAY</span> either happen in the token exchange step and the updated identifier is reflected in returned JWT authorization grant or in the assertion step where the updated identifier would be reflected in the access token. To support this both authorization servers <span class="bcp14">MAY</span> add, change or remove claims as described above.<a href="#section-3.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-2.2">
            <p id="section-3.5-2.2.1"><strong>Selective disclosure</strong>: Authorization servers <span class="bcp14">MAY</span> remove or hide certain claims due to privacy requirements or reduced trust towards the targeting trust domain. To hide and enclose claims <span>[<a href="#I-D.ietf-oauth-selective-disclosure-jwt" class="cite xref">I-D.ietf-oauth-selective-disclosure-jwt</a>]</span> <span class="bcp14">MAY</span> be used.<a href="#section-3.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-2.3">
            <p id="section-3.5-2.3.1"><strong>Controlling scope</strong>: Actors <span class="bcp14">MAY</span> use the scope parameter to control transcribed claims (e.g. downscoping). Authorization Servers <span class="bcp14">SHOULD</span> verify that requested scopes are not higher privileged than the scopes of presented subject_token.<a href="#section-3.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-2.4">
            <p id="section-3.5-2.4.1"><strong>Including JWT authorization grant claims</strong>: The authorization server performing the assertion flow <span class="bcp14">MAY</span> leverage claims from the presented JWT authorization grant and include them in the returned access token. The populated claims <span class="bcp14">SHOULD</span> be namespaced or validated to prevent the injection of invalid claims.<a href="#section-3.5-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.5-3">The representation of transcribed claims and their format is not defined in this specification.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-4-1">To be added.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="client-authentication">
<section id="section-5.1">
        <h3 id="name-client-authentication">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-client-authentication" class="section-name selfRef">Client Authentication</a>
        </h3>
<p id="section-5.1-1">Authorization Servers <span class="bcp14">SHOULD</span> follow the OAuth 2.0 Security Best Current Practice <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span> for client authentication.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-6">
      <h2 id="name-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-6.1">
        <h3 id="name-normative-references">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8693">[RFC8693]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Nadalin, A.</span>, <span class="refAuthor">Campbell, B., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OAuth 2.0 Token Exchange"</span>, <span class="seriesInfo">RFC 8693</span>, <span class="seriesInfo">DOI 10.17487/RFC8693</span>, <time datetime="2020-01" class="refDate">January 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8693">https://www.rfc-editor.org/rfc/rfc8693</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7523">[RFC7523]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Campbell, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7523</span>, <span class="seriesInfo">DOI 10.17487/RFC7523</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7523">https://www.rfc-editor.org/rfc/rfc7523</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8707">[RFC8707]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Resource Indicators for OAuth 2.0"</span>, <span class="seriesInfo">RFC 8707</span>, <span class="seriesInfo">DOI 10.17487/RFC8707</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8707">https://www.rfc-editor.org/rfc/rfc8707</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8414">https://www.rfc-editor.org/rfc/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-6.2">
        <h3 id="name-informative-references">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-oauth-selective-disclosure-jwt">[I-D.ietf-oauth-selective-disclosure-jwt]</dt>
        <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Yasuda, K.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"Selective Disclosure for JWTs (SD-JWT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-selective-disclosure-jwt-14</span>, <time datetime="2024-11-15" class="refDate">15 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-14">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-oauth-security-topics">[I-D.ietf-oauth-security-topics]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Labunets, A.</span>, and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"OAuth 2.0 Security Best Current Practice"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-security-topics-29</span>, <time datetime="2024-06-03" class="refDate">3 June 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-29">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-29</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-oauth-resource-metadata">[I-D.ietf-oauth-resource-metadata]</dt>
      <dd>
<span class="refAuthor">Jones, M. B.</span>, <span class="refAuthor">Hunt, P.</span>, and <span class="refAuthor">A. Parecki</span>, <span class="refTitle">"OAuth 2.0 Protected Resource Metadata"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-resource-metadata-13</span>, <time datetime="2024-10-15" class="refDate">15 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-resource-metadata-13">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-resource-metadata-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="use-cases">
<section id="appendix-A">
      <h2 id="name-use-cases">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-use-cases" class="section-name selfRef">Use cases</a>
      </h2>
<p id="appendix-A-1">This sections outlines some use cases where the identity and authorization chaining described in this document can be applied. The use cases described are not exhaustive, but are representative of the type of use cases enabled by this specification. Other use cases may also be supported by this specification.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="preserve-user-context-across-multi-cloud-multi-hybrid-environments">
<section id="appendix-A.1">
        <h3 id="name-preserve-user-context-acros">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-preserve-user-context-acros" class="section-name selfRef">Preserve User Context across Multi-cloud, Multi-Hybrid environments</a>
        </h3>
<p id="appendix-A.1-1">A user attempts to access a service that is implemented as a number of on-premise and cloud-based microservices. Both the on-premise and cloud-based services are segmented by multiple trust boundaries that span one or more on-premise or cloud service environments. Every microservice can apply an authorization policy that takes the context of the original user, as well as intermediary microservices into account, irrespective of where the microservices are running and even when a microservice in one trust domain calls another service in another trust domain.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="continuous-integration-accessing-external-resources">
<section id="appendix-A.2">
        <h3 id="name-continuous-integration-acce">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-continuous-integration-acce" class="section-name selfRef">Continuous Integration Accessing External Resources</a>
        </h3>
<p id="appendix-A.2-1">A continuous integration system needs to access external resources, for example to upload an artifact or to run tests. These resources are protected by different authorization servers. The identity information of the build, for example metadata such as commit hashes or repository, should be preserved and carried across the domain boundary. This not just prevents maintaining credentials it also allows fine grained access control at the resource.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="api-security-use-case">
<section id="appendix-A.3">
        <h3 id="name-api-security-use-case">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-api-security-use-case" class="section-name selfRef">API Security Use Case</a>
        </h3>
<p id="appendix-A.3-1">A home devices company provides a "Camera API" to enable access to home cameras. Partner companies use this Camera API to integrate the camera feeds into their security dashboards. Using OAuth between the partner and the Camera API, a partner can request the feed from a home camera to be displayed in their dashboard. The user has an account with the camera provider. The user may be logged in to view the partner provided dashboard, or they may authorize emergency access to the camera. The home devices company must be able to independently verify that the request originated and was authorized by a user who is authorized to view the feed of the requested home camera.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extend-single-sign-on-to-api-access">
<section id="appendix-A.4">
        <h3 id="name-extend-single-sign-on-to-ap">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-extend-single-sign-on-to-ap" class="section-name selfRef">Extend Single-Sign-On to API Access</a>
        </h3>
<p id="appendix-A.4-1">A user that authenticated to an enterprise Identity Provider (IdP) does not have to sign-in to multiple SaaS applications if the SaaS applications are configured to trust the enteprise IdP. It is possible to extend this SSO relationship to API access by allowing a client to contact the enterprise IdP and exchange the identity assertion (ID Token or SAML Token) that it previously received from the enteprise IdP for an authorization grant. The authorization grant can be used to obtain an access token from the SaaS application's authorization server, provided that a trust relationship has been established between the enterprise IdP which issues the authorization grant and the SaaS authorization server. As a result SaaS servers that trust the enterprise IdP do not require the user to complete an interactive delegated OAuth 2.0 flow to obtain an access token to access the SaaS provider's APIs.<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cross-domain-api-authorization">
<section id="appendix-A.5">
        <h3 id="name-cross-domain-api-authorizat">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-cross-domain-api-authorizat" class="section-name selfRef">Cross-domain API authorization</a>
        </h3>
<p id="appendix-A.5-1">An e-mail client can be used with arbitrary email servers, without requiring pre-established relationships between each email client and each email server. An e-mail client obtains an identity assertion (ID Token or SAML token) from an IdP. When the e-mail client needs access to a separate API, such as a third-party calendaring application, the email client exchanges the identity assertion for an authorization grant and uses this authorization grant to obtain an access token for the third-party calendaring application from the authorization server trusted by the third-party calendaring application. If the authorization server trusts the issuer of the authorization grant, the e-mail client obtains an access token without any additional user interaction.<a href="#appendix-A.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="appendix-B">
      <h2 id="name-examples">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-B-1">This section contains two examples, demonstrating how this specification may be used in different environments with specific requirements. It also gives concrete examples how entities take the role of "Actor". The first example shows the resource server as the Actor and the second example shows the authorization server as the Actor.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="resource-server-as-actor">
<section id="appendix-B.1">
        <h3 id="name-resource-server-as-actor">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-resource-server-as-actor" class="section-name selfRef">Resource server as Actor</a>
        </h3>
<p id="appendix-B.1-1">Resources servers may by Actors if the following is true:<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.1-2.1">
            <p id="appendix-B.1-2.1.1">Authorization Server B is reachable by the Resource Server of Domain A by network and is able to perform the appropriate client authentication (if required).<a href="#appendix-B.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.2">
            <p id="appendix-B.1-2.2.1">The Resource Server has the ability to determine the Authorization Server of Domain B.<a href="#appendix-B.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.1-3">The flow would look like this:<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
<span id="name-resource-server-as-actor-2"></span><figure id="figure-6">
          <div class="alignLeft art-text artwork" id="appendix-B.1-4.1">
<pre>
+-------------+          +--------+         +-------------+ +---------+
|Authorization|          |Resource|         |Authorization| |Protected|
|Server       |          |Server  |         |Server       | |Resource |
|Domain A     |          |Domain A|         |Domain B     | |Domain B |
|             |          |(Actor) |         |             | |         |
+-------------+          +--------+         +-------------+ +---------+
       |                     |                     |             |
       |                     |   (A) request protected resource  |
       |                     |      metadata                     |
       |                     | ---------------------------------&gt;|
       |                     | &lt;- - - - - - - - - - - - - - - - -|
       |                     |                     |             |
       | (B) exchange token  |                     |             |
       |   [RFC 8693]        |                     |             |
       |&lt;--------------------|                     |             |
       |                     |                     |             |
       | (C) &lt;authorization  |                     |             |
       |        grant&gt;       |                     |             |
       | - - - - - - - - - -&gt;|                     |             |
       |                     |                     |             |
       |                     | (D) present         |             |
       |                     |  authorization      |             |
       |                     |  grant [RFC 7523]   |             |
       |                     | -------------------&gt;|             |
       |                     |                     |             |
       |                     | (E) &lt;access token&gt;  |             |
       |                     | &lt;- - - - - - - - - -|             |
       |                     |                     |             |
       |                     |               (F) access          |
       |                     | ---------------------------------&gt;|
       |                     |                     |             |
       |                     |                     |             |
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-resource-server-as-actor-2" class="selfRef">Resource server as actor</a>
          </figcaption></figure>
<p id="appendix-B.1-5">The flow contains the following steps:<a href="#appendix-B.1-5" class="pilcrow">¶</a></p>
<p id="appendix-B.1-6">(A) The resource server of domain A needs to access protected resource in Domain B. It requires an access token to do so which it does not possess. In this example <span>[<a href="#I-D.ietf-oauth-resource-metadata" class="cite xref">I-D.ietf-oauth-resource-metadata</a>]</span> is used to receive information about the authorization server which protects the resource in domain B. This step <span class="bcp14">MAY</span> be skipped if discovery is not needed and other means of discovery <span class="bcp14">MAY</span> be used. The protected resource returns its metadata along with the authorization server information.<a href="#appendix-B.1-6" class="pilcrow">¶</a></p>
<p id="appendix-B.1-7">(B) Now, after the resource server has identified the authorization server for Domain B, the resource server requests a JWT authorization grant for the authorization server in Domain B from its own authorization server (Domain A). This happens via the token exchange protocol.<a href="#appendix-B.1-7" class="pilcrow">¶</a></p>
<p id="appendix-B.1-8">(C) If successful, the authorization server returns a JWT authorization grant to the resource server.<a href="#appendix-B.1-8" class="pilcrow">¶</a></p>
<p id="appendix-B.1-9">(D) The resource server presents the JWT authorization grant to the authorization server of Domain B.<a href="#appendix-B.1-9" class="pilcrow">¶</a></p>
<p id="appendix-B.1-10">(E) The authorization server of Domain B uses claims from the JWT authorization grant to identify the user and its access. If access is granted an access token is returned.<a href="#appendix-B.1-10" class="pilcrow">¶</a></p>
<p id="appendix-B.1-11">(F) The resource server uses the access token to access the protected resource at Domain B.<a href="#appendix-B.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-server-as-actor">
<section id="appendix-B.2">
        <h3 id="name-authorization-server-as-act">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-authorization-server-as-act" class="section-name selfRef">Authorization server as Actor</a>
        </h3>
<p id="appendix-B.2-1">Authorization servers may be Actors. This can be necessary because of following reasons:<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-2.1">
            <p id="appendix-B.2-2.1.1">Resource servers may not have knowledge of authorization servers.<a href="#appendix-B.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.2">
            <p id="appendix-B.2-2.2.1">Resource servers may not have network access to other authorization servers.<a href="#appendix-B.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.3">
            <p id="appendix-B.2-2.3.1">A strict access control on resources outside the trust domain is required and enforced by authorization servers.<a href="#appendix-B.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.4">
            <p id="appendix-B.2-2.4.1">Authorization servers require client authentication and managing clients for entities outside of the domain is not desired or feasible.<a href="#appendix-B.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.2-3">The flow where an authorization servers is an actor would look like this:<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
<span id="name-authorization-server-as-acto"></span><figure id="figure-7">
          <div class="alignLeft art-text artwork" id="appendix-B.2-4.1">
<pre>
+--------+          +-------------+         +-------------+ +---------+
|Resource|          |Authorization|         |Authorization| |Protected|
|Server  |          |Server       |         |Server       | |Resource |
|Domain A|          |Domain A     |         |Domain B     | |Domain B |
|        |          |(Actor)      |         |             | |         |
+--------+          +-------------+         +-------------+ +---------+
    |                      |                       |             |
    | (A) request or       |                       |             |
    | exchange token for   |                       |             |
    | protected resource   |                       |             |
    | in domain B.         |                       |             |
    | --------------------&gt;|                       |             |
    |                      |                       |             |
    |                      |----+                  |             |
    |                      |    | (B) determine    |             |
    |                      |&lt;---+ authorization    |             |
    |                      |      server B         |             |
    |                      |                       |             |
    |                      |                       |             |
    |                      |----+                  |             |
    |                      |    | (C) issue        |             |
    |                      |&lt;---+ authorization    |             |
    |                      |      grant ("internal |             |
    |                      |      token exchange") |             |
    |                      |                       |             |
    |                      |                       |             |
    |                      | (D) present           |             |
    |                      |   authorization grant |             |
    |                      |   [RFC 7523]          |             |
    |                      | ---------------------&gt;|             |
    |                      |                       |             |
    |                      | (E) &lt;access token&gt;    |             |
    |                      | &lt;- - - - - - - - - - -|             |
    |                      |                       |             |
    |  (F) &lt;access token&gt;  |                       |             |
    | &lt;- - - - - - - - - - |                       |             |
    |                      |                       |             |
    |                      |           (G) access  |             |
    | ----------------------------------------------------------&gt;|
    |                      |                       |             |
    |                      |                       |             |
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-authorization-server-as-acto" class="selfRef">Authorization server as Actor</a>
          </figcaption></figure>
<p id="appendix-B.2-5">The flow contains the following steps:<a href="#appendix-B.2-5" class="pilcrow">¶</a></p>
<p id="appendix-B.2-6">(A) The resource server of Domain A requests a token for the protected resource in Domain B from the authorization server in Domain A. This specification does not cover this step. A profile of Token Exchange <span>[<a href="#RFC8693" class="cite xref">RFC8693</a>]</span> may be used.<a href="#appendix-B.2-6" class="pilcrow">¶</a></p>
<p id="appendix-B.2-7">(B) The authorization server (of Domain A) determines the authorization server (of Domain B). This could have been indicated by a hint passed by the client, statically maintained or dynamically resolved.<a href="#appendix-B.2-7" class="pilcrow">¶</a></p>
<p id="appendix-B.2-8">(C) Once the authorization server is determined, a JWT authorization grant is issued internally. This reflects to <span><a href="#token-exchange" class="internal xref">Token exchange</a> (<a href="#token-exchange" class="auto internal xref">Section 3.3</a>)</span> of this specification and can be seen as an "internal token exchange".<a href="#appendix-B.2-8" class="pilcrow">¶</a></p>
<p id="appendix-B.2-9">(D) The issued JWT authorization grant is presented to the authorization server of Domain B. This presentation happens between the authorization servers and authorization server A may be required to perform client authentication while doing so.<a href="#appendix-B.2-9" class="pilcrow">¶</a></p>
<p id="appendix-B.2-10">(E) The authorization server of Domain B returns an access token for access to the protected resource in Domain B to the authorization server in Domain A.<a href="#appendix-B.2-10" class="pilcrow">¶</a></p>
<p id="appendix-B.2-11">(F) The authorization server of Domain A returns that access token to the resource server in Domain A.<a href="#appendix-B.2-11" class="pilcrow">¶</a></p>
<p id="appendix-B.2-12">(G) The resource server in Domain A uses the received access token to access the protected resource in Domain B.<a href="#appendix-B.2-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Acknowledgements">
<section id="appendix-C">
      <h2 id="name-acknowledgements">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-C-1">The editors would like to thank Joe Jubinski, Justin Richer, Aaron Parecki, Dean H. Saxe, and others (please let us know, if you've been mistakenly omitted) for their valuable input, feedback and general support of this work.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-D">
      <h2 id="name-document-history">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-D-1">[[ To be removed from the final specification ]]
-latest
* Added two more use cases
* Clarified terms, moved from "abstract client" to "'actor' role".<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">-02<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-3.1">
          <p id="appendix-D-3.1.1">remove recommendation to not use RFC8693's requested_token_type<a href="#appendix-D-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-3.2">
          <p id="appendix-D-3.2.1">Corrected discrepancy between alphabetic numbering of the diagram and text in the resource acting as client example<a href="#appendix-D-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-4">-01<a href="#appendix-D-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-5.1">
          <p id="appendix-D-5.1.1">limit the authorization grant format to RFC7523 JWT<a href="#appendix-D-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-5.2">
          <p id="appendix-D-5.2.1">minor example fixes<a href="#appendix-D-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-5.3">
          <p id="appendix-D-5.3.1">editorial fixes<a href="#appendix-D-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-5.4">
          <p id="appendix-D-5.4.1">added Aaron Parecki to acknowledgements<a href="#appendix-D-5.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-5.5">
          <p id="appendix-D-5.5.1">renamed section headers to be more explicit<a href="#appendix-D-5.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-5.6">
          <p id="appendix-D-5.6.1">use more specific term "JWT authorization grant"<a href="#appendix-D-5.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-5.7">
          <p id="appendix-D-5.7.1">changed name to "OAuth Identity and Authorization Chaining Across Domains"<a href="#appendix-D-5.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-5.8">
          <p id="appendix-D-5.8.1">move use cases to appendix and add continuous integration use case<a href="#appendix-D-5.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-6">-00<a href="#appendix-D-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-7.1">
          <p id="appendix-D-7.1.1">initial working group version (previously draft-schwenkschuster-oauth-identity-chaining)<a href="#appendix-D-7.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="contributors">
<section id="appendix-E">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Atul Tulshibagwale</span></div>
<div dir="auto" class="left"><span class="org">SGNL</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:atuls@sgnl.ai" class="email">atuls@sgnl.ai</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">George Fletcher</span></div>
<div dir="auto" class="left"><span class="org">Capital One</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:george.fletcher@capitalone.com" class="email">george.fletcher@capitalone.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rifaat Shekh-Yusef</span></div>
<div dir="auto" class="left"><span class="org">EY</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rifaat.shekh-yusef@ca.ey.com" class="email">rifaat.shekh-yusef@ca.ey.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@gmx.net" class="email">hannes.tschofenig@gmx.net</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Arndt Schwenkschuster</span></div>
<div dir="auto" class="left"><span class="org">SPIRL</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:arndts.ietf@gmail.com" class="email">arndts.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pieter Kasselmann</span></div>
<div dir="auto" class="left"><span class="org">SPIRL</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pieter@spirl.com" class="email">pieter@spirl.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kelley Burgin</span></div>
<div dir="auto" class="left"><span class="org">MITRE</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kburgin@mitre.org" class="email">kburgin@mitre.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Jenkins</span></div>
<div dir="auto" class="left"><span class="org">NSA-CCSS</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mjjenki@cyber.nsa.gov" class="email">mjjenki@cyber.nsa.gov</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Brian Campbell</span></div>
<div dir="auto" class="left"><span class="org">Ping Identity</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bcampbell@pingidentity.com" class="email">bcampbell@pingidentity.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
